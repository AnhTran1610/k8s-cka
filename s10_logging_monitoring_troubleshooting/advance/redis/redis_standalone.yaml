## Bitnami Redis image version
## ref: https://hub.docker.com/r/bitnami/redis/tags/
##
cluster:
  enabled: false
image:
  registry: docker.io
  repository: bitnami/redis
  ## Bitnami Redis image tag
  ## ref: https://github.com/bitnami/bitnami-docker-redis#supported-tags-and-respective-dockerfile-links
  ##
  tag: "5.0.5-debian-9-r169"
  ## Specify a imagePullPolicy
  ## Defaults to 'Always' if image tag is 'latest', else set to 'IfNotPresent'
  ## ref: http://kubernetes.io/docs/user-guide/images/#pre-pulling-images
  ##
  pullPolicy: IfNotPresent

## String to partially override redis.fullname template (will maintain the release name)
##
# nameOverride:

## String to fully override redis.fullname template
##
# fullnameOverride:

## Redis pod Security Context
securityContext:
  enabled: true
  fsGroup: 1001
  runAsUser: 1001
    
## ref: https://github.com/bitnami/bitnami-docker-redis#setting-the-server-password-on-first-run
##
usePassword: true
password: "password"

# Redis port
redisPort: 6379

##
## Redis Standalone parameters
##
standalone:
  ## Number replicas
  replicas: 2
  ## Redis command arguments
  ##
  ## Can be used to specify command line arguments, for example:
  ##
  command: "/run.sh"
  ## Additional Redis configuration for the Standalone nodes
  ## ref: https://redis.io/topics/config
  ##
  configmap: |-
    # Disable AOF https://redis.io/topics/persistence#append-only-file
    appendonly no
    # Enable RDB persistence
    save 900 1
    save 300 10
    save 60 10000
    maxmemory 1gb
    maxmemory-policy allkeys-lru
  ## Redis additional command line flags
  ##
  ## Can be used to specify command line flags, for example:
  ##
  ## extraFlags:
  ##  - "--maxmemory-policy volatile-ttl"
  ##  - "--repl-backlog-size 1024mb"
  extraFlags: []
  ## Comma-separated list of Redis commands to disable
  ##
  ## Can be used to disable Redis commands for security reasons.
  ## Commands will be completely disabled by renaming each to an empty string.
  ## ref: https://redis.io/topics/security#disabling-of-specific-commands
  ##
  ## Disable because of there is a bug in base image.
  ## https://github.com/helm/charts/issues/18825
  disableCommands:
  # - FLUSHDB
  # - FLUSHALL

  ## Redis Standalone additional pod labels and annotations
  ## ref: https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/
  podLabels: {}
  podAnnotations: {}

  ## Redis Standalone resource requests and limits
  ## ref: http://kubernetes.io/docs/user-guide/compute-resources/
  resources:
    requests:
      memory: 1000Mi
      cpu: 1

  ## Configure extra options for Redis Standalone liveness and readiness probes
  ## ref: https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/#configure-probes)
  ##
  livenessProbe:
    enabled: true
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 5
    successThreshold: 1
    failureThreshold: 5
  readinessProbe:
    enabled: true
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 1
    successThreshold: 1
    failureThreshold: 5

  ## Redis Standalone Node selectors and tolerations for pod assignment
  ## ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#nodeselector
  ## ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#taints-and-tolerations-beta-feature
  ##
  # nodeSelector: {"beta.kubernetes.io/arch": "amd64"}
  # tolerations: []
  ## Redis Standalone pod/node affinity/anti-affinity
  ##
  affinity: 
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
          - matchExpressions:
            - key: axon.pool
              operator: In
              values:
              - worker

  ## Enable persistence using Persistent Volume Claims
  ## ref: http://kubernetes.io/docs/user-guide/persistent-volumes/
  ##
  data:
    path: /data
    subPath: ""

## Sysctl InitContainer
## used to perform sysctl operation to modify Kernel settings (needed sometimes to avoid warnings)
# sysctlImage:
#   enabled: true
#   command:
#     - /bin/sh
#     - -c
#     - |-
#       sysctl -w net.core.somaxconn=10000
#       # sysctl -w vm.overcommit_memory=1
#       # echo never > /host-sys/kernel/mm/transparent_hugepage/enabled
#   registry: docker.io
#   repository: bitnami/minideb
#   tag: buster
#   pullPolicy: Always
#   ## Optionally specify an array of imagePullSecrets.
#   ## Secrets must be manually created in the namespace.
#   ## ref: https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/
#   ##
#   # pullSecrets:
#   #   - myRegistryKeySecretName
#   mountHostSys: true
#   resources:
#     requests:
#       memory: 128Mi
#       cpu: 100m